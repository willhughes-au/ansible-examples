# Playbook using Roles

Ansible Roles allow you to re-use common sets of tasks that might be used over multiple playbooks. 


Roles alwyas live in the subdirectory `roles`, and have a specific directory structure. 

See: https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html

In this example, we have two playbooks. 

One calls the role `test-file`

The second calls the role `test-file` and sets a variable. 

## Run 1

```
ansible-playbook -i ../02-inventory/my-inventory-file.yaml playbook-create-file.yaml
```

After running, look on the hosts at tmp/test-ansible-playbook.txt  -- you'll see a file with some info we generated by the role. 

## Output 1 

```
PLAY [Run on just pi group] *******************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************
ok: [sensepi01]
ok: [sensepi03]
ok: [sensepi02]

TASK [test-file : Create a test file /tmp/test-ansible-playbook.txt] **************************************************************************
changed: [sensepi01]
changed: [sensepi03]
changed: [sensepi02]

TASK [test-file : Delete the test file, if the var DELETE_IT_AFTER is set to true] ************************************************************
skipping: [sensepi01]
skipping: [sensepi02]
skipping: [sensepi03]

PLAY RECAP ************************************************************************************************************************************
sensepi01                  : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
sensepi02                  : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
sensepi03                  : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
```



## Run 2

```
ansible-playbook -i ../02-inventory/my-inventory-file.yaml playbook-cleanup-after.yaml
```

This creates the file in /tmp, and then immediately removes it with another step. 

## Output 2 

```
PLAY [Run on just pi group] *******************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************
ok: [sensepi01]
ok: [sensepi03]
ok: [sensepi02]

TASK [test-file : Create a test file /tmp/test-ansible-playbook.txt] **************************************************************************
changed: [sensepi01]
changed: [sensepi03]
changed: [sensepi02]

TASK [test-file : Delete the test file, if the var DELETE_IT_AFTER is set to true] ************************************************************
changed: [sensepi01]
changed: [sensepi03]
changed: [sensepi02]

PLAY RECAP ************************************************************************************************************************************
sensepi01                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
sensepi02                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
sensepi03                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

```